angular.module("BuscaAtivaEscolarAlert",["ngResource","ui.bootstrap","ui.select","pathgather.popeye","ui.utils.masks"]),angular.module("BuscaAtivaEscolarAlert").controller("formCtrl",function(e,a,t,i,l,r){e.isValid,e.alert,a.static=l,e.class="state-not-submitted",a.modal=function(a,t){e.isValid=a,e.alert=t;r.openModal({templateUrl:"confirm-dialog.html",controller:"formCtrl",closed:{}})},a.fetchCities=function(e){var t={name:e,$hide_loading_feedback:!0};return a.alert.place_uf&&(t.uf=a.alert.place_uf),console.log("[create_alert] Looking for cities: ",t),i.search(t).$promise.then(function(e){return e.results})},a.renderSelectedCity=function(e){return e?e.uf+" / "+e.name:""},a.createAlert=function(){if(console.log(e.isValid),console.log("Startando"),e.isValid){console.log("success");var a={email:e.alert.email,name:e.alert.name,place_reference:e.alert.place_reference,alert_cause_id:e.alert.alert_cause_id,mother_name:e.alert.mother_name,place_address:e.alert.place_address,place_neighborhood:e.alert.place_neighborhood,place_city_id:e.alert.place_city.ibge_city_id,place_city_name:e.alert.place_city.name,place_uf:e.alert.place_uf},i={headers:{"Content-Type":"application/json"}};return t.post("http://api.busca-ativa-escolar.dev.lqdi.net/api/v1/integration/lp/alert_spawn",JSON.stringify(a),i).then(function(a){e.class="state-submitted-successfully",r.closeCurrentModal(),console.log(a)})}r.closeCurrentModal(),console.log("Fail")}}),angular.module("BuscaAtivaEscolarAlert").factory("Cities",function(e){return headers={},e("http://api.busca-ativa-escolar.dev.lqdi.net/api/v1/cities/:id",{id:"@id"},{find:{method:"GET",headers:headers},search:{url:"http://api.busca-ativa-escolar.dev.lqdi.net/api/v1/cities/search",method:"POST",headers:headers},checkIfAvailable:{url:"http://api.busca-ativa-escolar.dev.lqdi.net/api/v1/cities/check_availability",method:"POST",headers:headers}})}),angular.module("BuscaAtivaEscolarAlert").factory("StaticData",function(e,a){function t(){console.log("[platform.static_data] Downloading latest static data definitions..."),h=a.get(f).then(l)}function i(){t()}function l(a){console.log("[platform.static_data] Downloaded! Version=",a.data.version,"Timestamp=",a.data.timestamp,"Data=",a.data.data),p=a.data.data,e.$broadcast("StaticData.ready")}function r(){return f}function n(){return p.length?p.length:0}function o(){return n()>0}function s(){return p.AlertCause?p.AlertCause:[]}function c(){return p.UFs?p.UFs:[]}function d(){return p.APIEndpoints?p.APIEndpoints:[]}function u(){return p.Config?p.Config.uploads.allowed_mime_types:[]}var p={},f="http://api.busca-ativa-escolar.dev.lqdi.net/api/v1/static/static_data?version=latest",h={};return{fetchLatestVersion:t,refresh:i,getAlertCauses:s,getAllowedMimeTypes:u,getUFs:c,getAPIEndpoints:d,isReady:o,getNumChains:n,getDataFile:r}}).run(function(e){e.refresh()});